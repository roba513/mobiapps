<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8">
  <title>캐데비 계산기</title>
  <style>
    body {
      background: linear-gradient(135deg, #232526 0%, #414345 100%);
      color: #f5f6fa;
      font-family: 'Pretendard', 'Noto Sans KR', 'Apple SD Gothic Neo', Arial, sans-serif;
      margin: 0;
      min-height: 100vh;
    }
    h2 {
      margin-top: 40px;
      font-size: 2.2em;
      font-weight: 800;
      letter-spacing: 1px;
      text-align: center;
      color: #ffd700;
      text-shadow: 0 2px 16px #0008;
    }
    .flex-col {
      display: flex;
      flex-direction: column;
      align-items: center;
      width: 100%;
    }
    .card {
      background: rgba(34, 40, 49, 0.98);
      border-radius: 22px;
      box-shadow: 0 4px 32px #0005, 0 1.5px 0 #ffd70033;
      padding: 32px 32px 24px 32px;
      margin: 32px 0 0 0;
      max-width: 900px;
      width: 95vw;
      transition: box-shadow 0.2s;
    }
    table {
      border-collapse: separate;
      border-spacing: 0;
      margin: 24px 0;
      background: #23272f;
      color: #f5f6fa;
      font-size: 1.13em;
      min-width: 520px;
      box-shadow: 0 2px 16px #0002;
      border-radius: 16px;
      overflow: hidden;
      width: 100%;
    }
    th,td {
      border: none;
      padding: 14px 18px;
      text-align: center;
    }
    th {
      background: #23272f;
      color: #ffd700;
      font-size: 1.08em;
      font-weight: 700;
      border-bottom: 2.5px solid #ffd70044;
      letter-spacing: 0.5px;
    }
    tr:not(:last-child) td {
      border-bottom: 1.5px solid #393e46;
    }
    input[type=number] {
      width: 100%;
      min-width: 70px;
      max-width: 120px;
      padding: 10px 8px;
      font-size: 1.08em;
      border-radius: 10px;
      border: 1.5px solid #ffd70099;
      background: #181b20;
      color: #ffd700;
      text-align: right;
      outline: none;
      transition: border 0.2s, box-shadow 0.2s;
      box-shadow: 0 1px 6px #0002 inset;
    }
    input[type=number]:focus {
      border: 2px solid #ffd700;
      background: #23272f;
      color: #fffbe7;
    }
    input[readonly] {
      background: #23272f;
      color: #ffd700bb;
      font-weight: 600;
    }
    button {
      font-size: 1.18em;
      padding: 13px 38px;
      margin: 28px 0 0 0;
      background: linear-gradient(90deg, #ffd700 60%, #ffe066 100%);
      color: #232526;
      border: none;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 800;
      box-shadow: 0 2px 12px #ffd70033;
      letter-spacing: 1px;
      transition: background 0.18s, box-shadow 0.18s, color 0.18s;
    }
    button:hover {
      background: linear-gradient(90deg, #ffe066 60%, #ffd700 100%);
      color: #181b20;
      box-shadow: 0 4px 24px #ffd70055;
    }
    .center { text-align: center; }
    @media (max-width: 900px) {
      .card { padding: 18px 2vw 12px 2vw; }
      table { min-width: 320px; font-size: 0.98em; }
      th,td { padding: 8px 4px; }
      input[type=number] { min-width: 48px; font-size: 0.98em; }
    }
    @media (max-width: 600px) {
      h2 { font-size: 1.2em; }
      .card { padding: 8px 0 8px 0; }
      table { font-size: 0.93em; }
    }
  </style>
</head>
<body>
  <h2>캐데비 계산기</h2>
  <div class="flex-col">
    <div class="card">
      <form id="mainForm" onsubmit="return false;">
        <table class="input-table">
          <tr>
            <th>룬 파편</th><th>엘리트 촉매</th><th>강화 촉매</th><th>룬 프리즘</th><th>보석 세공기</th><th>훈련 디스크</th>
          </tr>
          <tr>
            <td><input type="number" id="d0" value="123" required></td>
            <td><input type="number" id="d1" value="2904" required></td>
            <td><input type="number" id="d2" value="1681" required></td>
            <td><input type="number" id="d3" value="244" required></td>
            <td><input type="number" id="d4" value="500" required></td>
            <td><input type="number" id="d5" value="2266" required></td>
          </tr>
        </table>
        <table class="input-table">
          <tr><th>패키지</th><th>캐쉬</th><th>룬</th><th>강화</th><th>데카</th></tr>
          <tr>
            <td>월간각인</td>
            <td><input type="number" id="pkg_cash0" value="4900" readonly></td>
            <td><input type="number" id="pkg_rune0" value="700"></td>
            <td><input type="number" id="pkg_enh0" value="0"></td>
            <td><input type="number" id="pkg_deka0" value="4900"></td>
          </tr>
          <tr>
            <td>주간강화</td>
            <td><input type="number" id="pkg_cash1" value="2900" readonly></td>
            <td><input type="number" id="pkg_rune1" value="200"></td>
            <td><input type="number" id="pkg_enh1" value="5"></td>
            <td><input type="number" id="pkg_deka1" value="2900"></td>
          </tr>
          <tr>
            <td>봄맞이각인</td>
            <td><input type="number" id="pkg_cash2" value="3300" readonly></td>
            <td><input type="number" id="pkg_rune2" value="600"></td>
            <td><input type="number" id="pkg_enh2" value="3"></td>
            <td><input type="number" id="pkg_deka2" value="0"></td>
          </tr>
        </table>
        <div class="center"><button type="button" onclick="calcAll()">계산</button></div>
      </form>
    </div>
    <div class="card">
      <div id="result" class="center"></div>
      <div id="pkg_result" class="center"></div>
    </div>
  </div>
  <script>
    const labels = ['룬 파편','엘리트 촉매','강화 촉매','룬 프리즘','보석 세공기','훈련 디스크'];
    const cashPrices = [null, 850, 250, 50, 100, 500];
    function getKedebiColor(val, min, max) {
      if(isNaN(val)) return '';
      const t = (val - min) / (max - min + 0.0001);
      // t=1(최고) 진한 파랑, t=0(최저) 진한 빨강
      // 파랑: #0050ff (0,80,255), 빨강: #e53935 (229,57,53)
      const r = Math.round(229 * (1-t) + 0 * t);
      const g = Math.round(57 * (1-t) + 80 * t);
      const b = Math.round(53 * (1-t) + 255 * t);
      return `background:linear-gradient(90deg,rgba(${r},${g},${b},0.92),rgba(${r},${g},${b},0.82));color:#fff;font-weight:900;border-radius:8px;`;
    }
    function calcAll() {
      // 1. 단일품목 케데비 계산 및 값 수집
      const vals = [];
      for(let i=0;i<6;i++) vals.push(Number(document.getElementById('d'+i).value));
      let kedebiArr = [];
      let html1 = '<table><tr><th>물품</th><th>데카(구매)</th><th>데카(판매)</th><th>캐쉬가격</th><th>케데비</th></tr>';
      for(let i=0;i<6;i++) {
        const buy = vals[i];
        const sell = Math.round(buy*0.85*100)/100;
        const cash = cashPrices[i]!==null ? cashPrices[i] : '-';
        let ratio = '-';
        if(typeof cash==="number" && cash) {
          ratio = (sell/cash).toFixed(1);
          kedebiArr.push(parseFloat(ratio));
        }
        html1 += `<tr><td>${labels[i]}</td><td>${buy}</td><td>${sell}</td><td>${cash}</td>`;
        if(typeof cash==="number" && cash) {
          html1 += `<td id="kedebi_item_${i}">${ratio}</td>`;
        } else {
          html1 += `<td>${ratio}</td>`;
        }
        html1 += `</tr>`;
      }
      html1 += '</table>';
      document.getElementById('result').innerHTML = html1;

      // 2. 패키지 케데비 계산 및 값 수집
      const runeFrag = Number(document.getElementById('d0').value);
      const trainDisk = Number(document.getElementById('d5').value);
      let html2 = '<table><tr><th>패키지</th><th>캐쉬</th><th>룬</th><th>강화</th><th>데카</th><th>데카가치</th><th>케데비</th></tr>';
      for(let i=0;i<3;i++) {
        const name = ["월간각인","주간강화","봄맞이각인"][i];
        const cash = Number(document.getElementById('pkg_cash'+i).value);
        const rune = Number(document.getElementById('pkg_rune'+i).value);
        const enh = Number(document.getElementById('pkg_enh'+i).value);
        const deka = Number(document.getElementById('pkg_deka'+i).value);
        const dekaValue = deka + rune * runeFrag / 10 + enh * trainDisk;
        const ratio = cash ? (dekaValue / cash).toFixed(1) : '-';
        if (cash && dekaValue) {
          kedebiArr.push(parseFloat(ratio));
        }
        html2 += `<tr><td>${name}</td><td>${cash}</td><td>${rune}</td><td>${enh}</td><td>${deka}</td><td>${dekaValue.toFixed(2)}</td>`;
        if (cash && dekaValue) {
          html2 += `<td id="kedebi_pkg_${i}">${ratio}</td>`;
        } else {
          html2 += `<td>${ratio}</td>`;
        }
        html2 += `</tr>`;
      }
      html2 += '</table>';
      document.getElementById('pkg_result').innerHTML = html2;

      // 3. 전체 케데비 min/max로 색상 적용 (두 표 모두)
      if(kedebiArr.length>0) {
        const min = Math.min(...kedebiArr), max = Math.max(...kedebiArr);
        for(let i=0;i<6;i++) {
          const el = document.getElementById('kedebi_item_'+i);
          if(el) {
            const val = parseFloat(el.innerText);
            el.setAttribute('style', getKedebiColor(val, min, max));
          }
        }
        for(let i=0;i<3;i++) {
          const el = document.getElementById('kedebi_pkg_'+i);
          if(el) {
            const val = parseFloat(el.innerText);
            el.setAttribute('style', getKedebiColor(val, min, max));
          }
        }
      }
    }
    window.onload = calcAll;
  </script>
</body>
</html> 
